### R function for data munging the hospital data.

hosp_munge <- function(hospital) {
  hospital$hospital_death <- as.factor(hospital$hospital_death)
  levels(hospital$hospital_death) <- c("0", "1")
  hospital = subset(hospital, select = -c(encounter_id, patient_id, apache_4a_hospital_death_prob, apache_4a_icu_death_prob, X))
  
  hospital$ethnicity <- as.factor(hospital$ethnicity)
  hospital$ethnicity <- ifelse(hospital$ethnicity == "Caucasian", 1, hospital$ethnicity)
  hospital$gender <- as.factor(hospital$gender)
  hospital$gender <- ifelse(hospital$ethnicity == "M", 0, hospital$gender)
  hospital$gender <- ifelse(hospital$ethnicity == "F", 1, hospital$gender)
  hospital$icu_admit_source <- as.factor(hospital$icu_admit_source)
  hospital$icu_admit_source <- ifelse(hospital$icu_admit_source == "Accident & Emergency", 0, hospital$icu_admit_source)
  hospital$icu_admit_source <- ifelse(hospital$icu_admit_source == "Operating Room / Recovery", 1, hospital$icu_admit_source)
  hospital$icu_admit_source <- ifelse(hospital$icu_admit_source == "Floor", 2, hospital$icu_admit_source)
  hospital$icu_admit_source <- ifelse(hospital$icu_admit_source == "Other Hospital", 3, hospital$icu_admit_source)
  hospital$icu_admit_source <- ifelse(hospital$icu_admit_source == "Other ICU", 4, hospital$icu_admit_source)
  hospital$icu_stay_type <- as.factor(hospital$icu_stay_type)
  hospital$icu_stay_type <- ifelse(hospital$icu_stay_type == "admit", 0, hospital$icu_stay_type)
  hospital$icu_stay_type <- ifelse(hospital$icu_stay_type == "readmit", 1, hospital$icu_stay_type)
  hospital$icu_stay_type <- ifelse(hospital$icu_stay_type == "transfer", 2, hospital$icu_stay_type)
  hospital$icu_type <- as.factor(hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "Med-Surg ICU", 0, hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "MICU", 1, hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "CTICU", 2, hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "CCU-CTICU", 3, hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "Neuro ICU", 4, hospital$icu_type)
  hospital$icu_type <- ifelse(hospital$icu_type == "SICU", 5, hospital$icu_type)
  hospital$apache_3j_bodysystem <- as.factor(hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Cardiovascular", 0, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Metabolic", 1, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Nuerological", 2, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Gastrointestinal", 3, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Metabolic", 4, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Musculoskeletal/Skin", 5, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Respiratory", 6, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Trauma", 7, hospital$apache_3j_bodysystem)
  hospital$apache_3j_bodysystem <- ifelse(hospital$apache_3j_bodysystem == "Genitourinary", 8, hospital$apache_3j_bodysystem)
  hospital$apache_2_bodysystem <- as.factor(hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Cardiovascular", 0, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Metabolic", 1, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Nuerological", 2, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Gastrointestinal", 3, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Metabolic", 4, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Musculoskeletal/Skin", 5, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Respiratory", 6, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Trauma", 7, hospital$apache_2_bodysystem)
  hospital$apache_2_bodysystem <- ifelse(hospital$apache_2_bodysystem == "Genitourinary", 8, hospital$apache_2_bodysystem)
  
  return(hospital)
  
}
