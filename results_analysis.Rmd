---
title: "STAT 6440 Final Project Analysis"
author: "Dan Mrachko"
date: "4/20/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

source("data_munge_funcs.R")
library(caret)
library(rpart)
library(rpart.plot)
library(glmnet)
library(tidyr)
RNGkind(sample.kind = "Rounding")
load("6modelResults.RData")

```


``` {r fig1, fig.align = 'center', fig.width = 12, fig.height = 6, echo = FALSE}
# Compute Optimal Cut-off values for the Lasso Logistic Regression Models
lasso_mice_cutoffs <- cutoff_opt(mice.test, LASSO_MICE_PRED, pos_val = "0")
lasso_drop_cutoffs <- cutoff_opt(drop.test, LASSO_DROP_PRED, pos_val = "0")
lasso_mm_cutoffs <- cutoff_opt(mm.test, LASSO_MM_PRED, pos_val = "0")


lasso_mice_summary <- as.data.frame(lasso_mice_cutoffs$best_kappa)
lasso_mice_summary <- cbind(lasso_mice_summary, lasso_mice_cutoffs$best_acc)
colnames(lasso_mice_summary) <- c("Max Kappa", "Max Accuracy")

lasso_drop_summary <- as.data.frame(lasso_drop_cutoffs$best_kappa)
lasso_drop_summary <- cbind(lasso_drop_summary, lasso_drop_cutoffs$best_acc)
colnames(lasso_drop_summary) <- c("Max Kappa", "Max Accuracy")

lasso_mm_summary <- as.data.frame(lasso_mm_cutoffs$best_kappa)
lasso_mm_summary <- cbind(lasso_mm_summary, lasso_mm_cutoffs$best_acc)
colnames(lasso_mm_summary) <- c("Max Kappa", "Max Accuracy")



par(mfrow = c(1,2))

plot(lasso_mice_cutoffs$res_matrix[,c(1,3)], col="blue", type='p', lwd = 2, main="Lasso Regression Cut-off Optimization: Kappa")
lines(lasso_drop_cutoffs$res_matrix[,c(1,3)], col="green", type='l', lwd = 2)
lines(lasso_mm_cutoffs$res_matrix[,c(1,3)], col = "red", type = 'p', lwd = 2)
grid(nx = NULL, ny=NULL, col = "lightgray")
legend(x = "bottom", legend = c("MICE Data Model","NA Dropped Data Model", "Mean/Mode Replaced Data Model"), lty = c(0,1,0), lwd = c(2,2,2), pch = c(1,NA,1), col = c("blue", "green", "red"), cex = 0.9)

plot(lasso_mice_cutoffs$res_matrix[,c(1,2)], col="blue", type='p', lwd = 2, main="Lasso Regression Cut-off Optimization: Accuracy")
lines(lasso_drop_cutoffs$res_matrix[,c(1,2)], col="green", type='l', lwd = 2)
lines(lasso_mm_cutoffs$res_matrix[,c(1,2)], col = "red", type = 'p', lwd = 2)
grid(nx = NULL, ny=NULL, col = "lightgray")
legend(x = "bottomright", legend = c("MICE Data Model","NA Dropped Data Model", "Mean/Mode Replaced Data Model"), lty = c(0,1,0), lwd = c(2,2,2), pch = c(1,NA,1), col = c("blue", "green", "red"), cex = 0.9)


```

```{r}
lasso_mice_summary
lasso_drop_summary
lasso_mm_summary

```

```{r include=FALSE}
# Compute Optimal Cut-off values for the Classification Tree Models
ct_mice_cutoffs <- cutoff_opt(mice.test, CT_MICE_PROB, pos_val = "0")
ct_drop_cutoffs <- cutoff_opt(drop.test, CT_DROP_PROB, pos_val = "0")
ct_mm_cutoffs <- cutoff_opt(mm.test, CT_MM_PROB, pos_val = "0")

```


``` {r fig2, fig.align = 'center', fig.width = 12, fig.height = 6, echo=FALSE}

ct_mice_summary <- as.data.frame(ct_mice_cutoffs$best_kappa)
ct_mice_summary <- cbind(ct_mice_summary, ct_mice_cutoffs$best_acc)
colnames(ct_mice_summary) <- c("Max Kappa", "Max Accuracy")

ct_drop_summary <- as.data.frame(ct_drop_cutoffs$best_kappa)
ct_drop_summary <- cbind(ct_drop_summary, ct_drop_cutoffs$best_acc)
colnames(ct_drop_summary) <- c("Max Kappa", "Max Accuracy")

ct_mm_summary <- as.data.frame(ct_mm_cutoffs$best_kappa)
ct_mm_summary <- cbind(ct_mm_summary, ct_mm_cutoffs$best_acc)
colnames(ct_mm_summary) <- c("Max Kappa", "Max Accuracy")



par(mfrow = c(1,2))

plot(ct_mice_cutoffs$res_matrix[,c(1,3)], col="blue", type='p', lwd = 2, main="Classification Tree Cut-off Optimization: Kappa")
lines(ct_drop_cutoffs$res_matrix[,c(1,3)], col="green", type='l', lwd = 2)
lines(ct_mm_cutoffs$res_matrix[,c(1,3)], col = "red", type = 'p', lwd = 2)
grid(nx = NULL, ny=NULL, col = "lightgray")
legend(x = "bottom", legend = c("MICE Data Model","NA Dropped Data Model", "Mean/Mode Replaced Data Model"), lty = c(0,1,0), lwd = c(2,2,2), pch = c(1,NA,1), col = c("blue", "green", "red"), cex = 0.9)

plot(ct_mice_cutoffs$res_matrix[,c(1,2)], col="blue", type='p', lwd = 2, main="Classification Tree Cut-off Optimization: Accuracy")
lines(ct_drop_cutoffs$res_matrix[,c(1,2)], col="green", type='l', lwd = 2)
lines(ct_mm_cutoffs$res_matrix[,c(1,2)], col = "red", type = 'p', lwd = 2)
grid(nx = NULL, ny=NULL, col = "lightgray")
legend(x = "bottomright", legend = c("MICE Data Model","NA Dropped Data Model", "Mean/Mode Replaced Data Model"), lty = c(0,1,0), lwd = c(2,2,2), pch = c(1,NA,1), col = c("blue", "green", "red"), cex = 0.9)


```

```{r}
ct_mice_summary
ct_drop_summary
ct_mm_summary

```
 


